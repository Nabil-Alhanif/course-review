import{l as V,_ as T,r as b,o as n,e as o,F as U,h as E,b as t,t as c,c as _,i as p,m as q,n as F,d as P,u as $,g}from"./index-BtAOUD_i.js";import{A as W,a as N,b as R,u as z}from"./course-C718dtxm.js";const O=e=>e&&Object.keys(e).length===0&&e.constructor===Object,D="https://script.google.com/macros/s/AKfycbzC-fCdBpr00Qt7Dy2w6u66qEDQ5GDKUXEagKeSjpKF5Ex_WELXqjhbq-xPyjCA-ty3ug/exec",K={type:"object",properties:{id:{type:"string",format:"uuid"},user_id:{type:"string",format:"uuid"},course_id:{type:"string",format:"uuid"},instructor_id:{type:"string",format:"uuid"},reviewer_faculty:{type:"string"},reviewer_standing:{type:"string"},instructor_name:{type:"string"},instructor_rating:{type:"integer"},workload:{type:"integer"},difficulties:{type:"integer"},recommended:{type:"string",enum:["Yes","No","Maybe"]},description:{type:"string"},tips:{type:"string"},timestamp:{type:"string",format:"date-time"}},required:["id","user_id","course_id","instructor_id","reviewer_faculty","reviewer_standing","instructor_name","instructor_rating","workload","difficulties","recommended","description","tips","timestamp"]},G={type:"array",items:K},L=new W;N(L);const I=L.compile(G);function S(e){return e.slice().sort((s,d)=>{const i=new Date(s.timestamp);return new Date(d.timestamp)-i})}const Q=V({id:"review",state:()=>({reviews:[],loading:!1,error:null}),getters:{},actions:{async fetchReviews(){this.reviews=[],this.loading=!0,this.error=null;try{const e=await R.get(D,{params:{action:"getReviews"}});if(e.data.error)throw new Error(e.data.error);if(!I(e.data))throw new Error("Invalid response format");this.reviews=S(e.data)}catch(e){throw this.error=e.message||"An error occured",{status:e.status||500,message:this.error}}finally{this.loading=!1}},async fetchReviewsById(e){this.reviews=[],this.loading=!0,this.error=null;try{if(O(e))throw new Error("ID is empty!");const s=await R.get(D,{params:{action:"getReviewsById",...e}});if(s.data.error)throw new Error(s.data.error);if(!I(s.data))throw new Error("Invalid response format");this.reviews=S(s.data)}catch(s){throw this.error=s.message||"An error occured",{status:s.status||500,message:this.error}}finally{this.loading=!1}}}});var r=[];for(var x=0;x<256;++x)r.push((x+256).toString(16).slice(1));function Z(e,s=0){return(r[e[s+0]]+r[e[s+1]]+r[e[s+2]]+r[e[s+3]]+"-"+r[e[s+4]]+r[e[s+5]]+"-"+r[e[s+6]]+r[e[s+7]]+"-"+r[e[s+8]]+r[e[s+9]]+"-"+r[e[s+10]]+r[e[s+11]]+r[e[s+12]]+r[e[s+13]]+r[e[s+14]]+r[e[s+15]]).toLowerCase()}var w,X=new Uint8Array(16);function Y(){if(!w&&(w=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!w))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return w(X)}var J=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const C={randomUUID:J};function ee(e,s,d){if(C.randomUUID&&!s&&!e)return C.randomUUID();e=e||{};var i=e.random||(e.rng||Y)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Z(i)}const te={class:"mt-0.5 flex items-center ml-3"},se={class:"w-4 h-4 me-1","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 22 20"},re=["id"],ne=["offset"],oe=["offset"],ie=["fill","d"],ae={class:"ms-1 text-sm font-medium text-gray-500 dark:text-gray-400"},le={__name:"IconRating",props:{rating:{type:Number,required:!0},maxRating:{type:Number,default:5,required:!1},svgPath:{type:String,required:!0}},setup(e){const s=e,d=b(`half-filled-${ee()}`),i=u=>{const m=s.rating-u+1;return m>=1?100:m<=0?0:Math.round(m*100*100)/100};return(u,m)=>(n(),o("div",te,[(n(!0),o(U,null,E(e.maxRating,a=>(n(),o("div",{key:a,class:"star-wrapper"},[(n(),o("svg",se,[t("defs",null,[t("linearGradient",{id:d.value+"-"+a},[t("stop",{offset:i(a)+"%","stop-color":"var(--start-color)"},null,8,ne),t("stop",{offset:i(a)+"%","stop-color":"var(--end-color)"},null,8,oe)],8,re)]),t("path",{fill:"url(#"+d.value+"-"+a+")",d:e.svgPath},null,8,ie)]))]))),128)),t("p",ae,c(e.rating.toFixed(2))+" out of "+c(e.maxRating),1)]))}},k=T(le,[["__scopeId","data-v-84c791c2"]]),ce={class:"bg-white rounded-lg shadow-lg dark:bg-gray-100"},de={class:"p-5 flex"},ue={class:"w-9/12 mr-3"},me={class:"flex"},he={class:"w-3/12"},ve={href:"#"},_e={class:"mb-2 text-2xl font-bold tracking-tight text-gray-900"},fe={class:"mt-1 w-2/12 font-semibold"},ge={class:"mt-1 w-2/12 font-semibold"},we={class:"mt-1 w-2/12 font-semibold"},pe=t("hr",{class:"mt-2 mb-2"},null,-1),ye=t("h1",null,"About the course:",-1),xe=["innerHTML"],be=t("h1",null,"Tips to excel:",-1),ke=["innerHTML"],$e={class:"object-center"},Re=t("h5",{class:"font-bold text-gray-900 mb-2 text-xl"},"Reviewer Info:",-1),De={class:"flex-col"},Ie=t("td",null,"Faculty",-1),Se=t("td",null,":",-1),Ce=t("td",null,"Standing",-1),Ue=t("td",null,":",-1),Ee=t("td",null,"Date of review",-1),Le=t("td",null,":",-1),je={__name:"ReviewCard",props:{review:{type:Object,default:()=>({id:"0",user_id:"0",course_id:"0",instructor_id:"0",instructor_name:"Unknown Instructor",reviewer_faculty:"Unknown Faculty",reviewer_standing:"Unknown Standing",instructor_rating:1,workload:1,difficulties:1,recommended:"Yes",description:"No description",tips:"No tips",timestamp:"-"})}},setup(e){const s=e,d=_(()=>`<p>${s.review.description.replace(/\n/g,"<br>")}</p>`),i=_(()=>`<p>${s.review.tips.replace(/\n/g,"<br>")}</p>`);return(u,m)=>(n(),o("div",ce,[t("div",de,[t("div",ue,[t("div",me,[t("div",he,[t("a",ve,[t("h5",_e,c(e.review.instructor_name),1)]),p(k,{rating:e.review.instructor_rating,svgPath:"M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z"},null,8,["rating"])]),t("div",fe,"Difficulty: "+c(e.review.difficulties),1),t("div",ge,"Workload: "+c(e.review.workload),1),t("div",we,"Recommended: "+c(e.review.recommended),1)]),pe,ye,t("div",{class:"mb-3 font-normal text-gray-700 dark:text-gray-700",innerHTML:d.value},null,8,xe),be,t("div",{class:"mb-3 font-normal text-gray-700 dark:text-gray-700",innerHTML:i.value},null,8,ke)]),t("div",null,[t("div",$e,[Re,t("div",null,[t("table",De,[t("tr",null,[Ie,Se,t("td",null,c(e.review.reviewer_faculty),1)]),t("tr",null,[Ce,Ue,t("td",null,c(e.review.reviewer_standing),1)]),t("tr",null,[Ee,Le,t("td",null,c(e.review.timestamp),1)])])])])])])]))}},Be={class:"flex flex-col bg-white"},Me={class:"flex flex-col pt-4 px-20 w-full max-md:px-5 max-md:max-w-full"},Ae={key:0},He={key:1},Ve={key:2,class:"max-md:max-w-full"},Te={class:"flex gap-5 max-md:flex-col max-md:gap-0"},qe=t("div",{class:"flex flex-col w-[56%] max-md:ml-0 max-md:w-full items-center justify-center"},[t("img",{loading:"lazy",src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSDFq5wKktyhpmM9hOT06s-vEDuTaP_W_v0lw&s",alt:"imge",class:"w-60 h-60 items-center justify-center rounded-lg"})],-1),Fe={class:"flex flex-col ml-5 w-[44%] max-md:ml-0 max-md:w-full"},Pe={class:"flex flex-col justify-center font-medium leading-[150%] text-zinc-500 max-md:mt-10 max-md:max-w-full"},We={class:"text-4xl font-semibold leading-10 text-black max-md:max-w-full"},Ne={class:"mt-2 text-xl font-semibold max-md:max-w-full"},ze={key:0},Oe=t("p",null,"Difficulty",-1),Ke={key:1},Ge=t("p",null,"Workload",-1),Qe={key:3},Ze={key:4},Xe={key:5},Ye={key:6,class:"mt-20 max-md:mt-10 max-md:max-w-full"},Je=t("h3",{class:"text-2xl leading-9 font-medium text-slate-700 text-center mb-10 border-b-[1px] p-4"}," See what other students have to say ",-1),st={__name:"CourseView",setup(e){const s=q(),d=z(),i=Q(),u=b(null),m=b(null),a=_(()=>d.course),h=_(()=>i.reviews),j=async l=>{u.value=null;try{await d.fetchCourseByCode(l)}catch(v){u.value=v}},B=async l=>{m.value=null;try{await i.fetchReviewsById({courseId:l})}catch(v){m.value=v}},M=_(()=>{var l;return(l=a==null?void 0:a.value)==null?void 0:l.code.replace(/(\D)(\d)/,"$1 $2")}),y=_(()=>h.value.length?h.value.reduce((v,f)=>v+f.difficulties,0)/h.value.length:null),A=_(()=>h.value.length?h.value.reduce((v,f)=>v+f.workload,0)/h.value.length:null),H=()=>{window.open("https://forms.gle/8sSfxZrQTLRvx1zz7","_blank")};return F(a,l=>{l&&B(l.id)},{immediate:!0}),P(()=>{j(s.params.code)}),(l,v)=>(n(),o("div",Be,[t("main",Me,[$(d).loading?(n(),o("p",Ae,"Loading course information....")):u.value?(n(),o("p",He,c(u.value.message),1)):a.value?(n(),o("section",Ve,[t("div",Te,[qe,t("div",Fe,[t("div",Pe,[t("h2",We,c(M.value),1),t("p",Ne,c(a.value.title),1),y.value!==null?(n(),o("div",ze,[Oe,p(k,{rating:y.value,svgPath:"M17.71,7.29a1,1,0,0,0-1-.25,1,1,0,0,0-.7.73,4.37,4.37,0,0,1-.45,1.13,10.89,10.89,0,0,0-5-6.73A1,1,0,0,0,9,3,7.1,7.1,0,0,1,6.6,8.38C5.38,9.71,4,11.22,4,14c0,5,3,8,8,8s8-2.91,8-8C20,12,19,8.58,17.71,7.29Z"},null,8,["rating"])])):g("",!0),y.value!==null?(n(),o("div",Ke,[Ge,p(k,{rating:A.value,svgPath:"M20 18v-4h-3v1h-2v-1H9v1H7v-1H4v4h16M6.33 8l-1.74 4H7v-1h2v1h6v-1h2v1h2.41l-1.74-4H6.33M9 5v1h6V5H9m12.84 7.61c.1.22.16.48.16.8V18c0 .53-.21 1-.6 1.41c-.4.4-.85.59-1.4.59H4c-.55 0-1-.19-1.4-.59C2.21 19 2 18.53 2 18v-4.59c0-.32.06-.58.16-.8L4.5 7.22C4.84 6.41 5.45 6 6.33 6H7V5c0-.55.18-1 .57-1.41C7.96 3.2 8.44 3 9 3h6c.56 0 1.04.2 1.43.59c.39.41.57.86.57 1.41v1h.67c.88 0 1.49.41 1.83 1.22l2.34 5.39z"},null,8,["rating"])])):g("",!0),t("button",{class:"justify-center items-center px-6 py-3.5 mt-6 text-base text-white bg-gradient-to-r to-emerald-600 from-sky-400 rounded-lg shadow-sm max-md:px-5 max-md:max-w-full",onClick:H}," Submit a review ")])])])])):g("",!0),a.value?$(i).loading?(n(),o("p",Ze,"Loading reviews...")):m.value?(n(),o("p",Xe,c(m.value.message),1)):h.value?(n(),o("section",Ye,[Je,(n(!0),o(U,null,E(h.value,f=>(n(),o("div",{key:f.id,class:"mt-4 max-md:max-w-full space-y-6 mb-20"},[p(je,{review:f},null,8,["review"])]))),128))])):g("",!0):(n(),o("p",Qe,"Waiting for course to be loaded..."))])]))}};export{st as default};
